# A0093999Y
###### /java/guitests/TaskManagerGuiTest.java
``` java
    protected TypicalTasks td = new TypicalTasks();
    protected Task[] emptyTaskList = new Task[] {};
    protected Task[] todayList = td.getTodayListTasks();
    protected Task[] futureList = td.getFutureListTasks();
    protected Task[] completedList = td.getCompletedListTasks();

    // @author
    /*
     * Handles to GUI elements present at the start up are created in advance
     * for easy access from child classes.
     */
    protected MainGuiHandle mainGui;
    protected MainMenuHandle mainMenu;
    protected TodayTaskListPanelHandle todayTaskListPanel;
    protected FutureTaskListPanelHandle futureTaskListPanel;
    protected CompletedTaskListHandle completedTaskListPanel;
    protected ResultDisplayHandle resultDisplay;
    protected CommandBoxHandle commandBox;
    protected BrowserPanelHandle browserPanel;
    private Stage stage;
    protected Logic logic;

    @BeforeClass
    public static void setupSpec() {
        try {
            FxToolkit.registerPrimaryStage();
            FxToolkit.hideStage();
        } catch (TimeoutException e) {
            e.printStackTrace();
        }
    }

    @Before
    public void setup() throws Exception {
        FxToolkit.setupStage((stage) -> {
            mainGui = new MainGuiHandle(new GuiRobot(), stage);
            mainMenu = mainGui.getMainMenu();
            futureTaskListPanel = mainGui.getFutureTaskListPanel();
            todayTaskListPanel = mainGui.getTodayTaskListPanel();
            completedTaskListPanel = mainGui.getCompletedTaskList();
            resultDisplay = mainGui.getResultDisplay();
            commandBox = mainGui.getCommandBox();
            browserPanel = mainGui.getBrowserPanel();
            this.stage = stage;
        });
        EventsCenter.clearSubscribers();
        testApp = (TestApp) FxToolkit.setupApplication(() -> new TestApp(this::getInitialData, getDataFileLocation()));
        FxToolkit.showStage();
        while (!stage.isShowing())
            ;
        mainGui.focusOnMainApp();
    }

    /**
     * Override this in child classes to set the initial local data. Return null
     * to use the data in the file specified in {@link #getDataFileLocation()}
     */
    protected TaskManager getInitialData() {
        TaskManager ab = new TaskManager();
        td.loadTaskManagerWithSampleData(ab);
        return ab;
    }

    /**
     * Override this in child classes to set the data file location.
     */
    protected String getDataFileLocation() {
        return TestApp.SAVE_LOCATION_FOR_TESTING;
    }

    @After
    public void cleanup() throws TimeoutException {
        FxToolkit.cleanupStages();
    }

    /**
     * Asserts the task shown in the card is same as the given task
     */
    public void assertMatching(ReadOnlyTask task, TaskCardHandle card) {
        assertTrue(TestUtil.compareCardAndTask(card, task));
    }

    /**
     * Asserts the size of the task list is equal to the given number.
     */
    protected void assertFutureListSize(int size) {
        int numberOfTasks = futureTaskListPanel.getNumberOfTasks();
        assertEquals(size, numberOfTasks);
    }

```
###### /java/guitests/TaskManagerGuiTest.java
``` java
    /**
     * Asserts the UI Today and Future Task Lists match the given expected lists
     */
    protected void assertTodayFutureListsMatching(Task[] todayList, Task[] futureList) throws IllegalValueException {
        assertTrue(todayTaskListPanel.isListMatching(todayList));
        assertTrue(futureTaskListPanel.isListMatching(futureList));
    }

    /**
     * Asserts the All UI Task Lists match the given expected lists
     */
    protected void assertAllListsMatching(Task[] todayList, Task[] futureList, Task[] completedList)
            throws IllegalValueException {
        assertTodayFutureListsMatching(todayList, futureList);
        commandBox.runCommand("listcompleted");
        assertTrue(completedTaskListPanel.isListMatching(completedList));
        commandBox.runCommand("list");
    }

    // @author
    /**
     * Asserts the message shown in the Result Display area is same as the given
     * string.
     */
    protected void assertResultMessage(String expected) {
        logger.info("Expected:" + expected);
        logger.info("Actual:" + resultDisplay.getText());
        assertEquals(expected, resultDisplay.getText());
    }

    public void raise(BaseEvent e) {
        // JUnit doesn't run its test cases on the UI thread. Platform.runLater
        // is used to post event on the UI thread.
        Platform.runLater(() -> EventsCenter.getInstance().post(e));
    }
}
```
###### /java/guitests/TodayAndNotTodayCommandTest.java
``` java
public class TodayAndNotTodayCommandTest extends TaskManagerGuiTest {

    @Test
    public void todayAndNotTodayTask_nonEmptyList_invalidIndex() {
        assertTodayIndexInvalid("T100"); // invalid index
        assertNotTodayIndexInvalid("F100"); // invalid index
    }

    @Test
    public void todayAndNotTodayTask_nonEmptyList_success() throws IllegalArgumentException, IllegalValueException {
        // No Change
        commandBox.runCommand("today T4");
        assertTodayFutureListsMatching(todayList, futureList);

        // Move Task from future to today
        commandBox.runCommand("today F1");
        todayList = TestUtil.addTasksToList(todayList, td.futureListFloat, 2);
        futureList = TestUtil.removeTaskFromList(futureList, 1);
        assertTodayFutureListsMatching(todayList, futureList);

        // No Change
        commandBox.runCommand("nottoday T1");
        assertTodayFutureListsMatching(todayList, futureList);

        // Move Task from today to future
        commandBox.runCommand("nottoday T2");
        todayList = TestUtil.removeTaskFromList(todayList, 2);
        futureList = TestUtil.addTasksToList(futureList, td.todayListFloat, 0);
        assertTodayFutureListsMatching(todayList, futureList);
    }

    @Test
    public void todayAndNotTask_emptyList() {
        commandBox.runCommand("clear");
        assertFutureListSize(0);
        assertTodayIndexInvalid("F1"); // invalid index
        assertNotTodayIndexInvalid("T1"); // invalid index
    }

    // ------------------Helper---------------------

    private void assertTodayIndexInvalid(String index) {
        commandBox.runCommand("today " + index);
        assertResultMessage(Messages.MESSAGE_INVALID_TASK_DISPLAYED_INDEX);
    }

    private void assertNotTodayIndexInvalid(String index) {
        commandBox.runCommand("nottoday " + index);
        assertResultMessage(Messages.MESSAGE_INVALID_TASK_DISPLAYED_INDEX);
    }
}
```
###### /java/guitests/DoneAndNotDoneCommandTest.java
``` java
public class DoneAndNotDoneCommandTest extends TaskManagerGuiTest {

    @Test
    public void doneTask_nonEmptyList_invalid() {
        assertDoneIndexInvalid("T100"); // invalid index
        assertNotDoneIndexInvalid("C100");
    }

    @Test
    public void doneTask_todayList_success() throws IllegalArgumentException, IllegalValueException {
        // --- Done ---
        commandBox.runCommand("done T2");
        Task doneTask = todayList[1];
        doneTask.setDone(true);
        Task[] expectedTodayList = TestUtil.removeTaskFromList(todayList, 2);
        Task[] expectedCompletedList = TestUtil.addTasksToList(completedList, doneTask, 0);
        assertTrue(todayTaskListPanel.isListMatching(expectedTodayList));
        commandBox.runCommand("listcompleted");
        assertTrue(completedTaskListPanel.isListMatching(expectedCompletedList));

        // --- Not Done ---

        commandBox.runCommand("notdone C2");
        expectedTodayList = TestUtil.addTasksToList(expectedTodayList, td.completedListFloat, 1);
        expectedCompletedList = TestUtil.removeTaskFromList(expectedCompletedList, 2);
        assertTrue(todayTaskListPanel.isListMatching(expectedTodayList));
        assertTrue(completedTaskListPanel.isListMatching(expectedCompletedList));

    }

    @Test
    public void doneTask_emptyList() {
        commandBox.runCommand("clear");
        assertFutureListSize(0);
        assertDoneIndexInvalid("F1"); // invalid index
        assertNotDoneIndexInvalid("C1"); // invalid index
    }

    // ------ Helper ------

    private void assertDoneIndexInvalid(String index) {
        commandBox.runCommand("done " + index);
        assertResultMessage(Messages.MESSAGE_INVALID_TASK_DISPLAYED_INDEX);
    }

    private void assertNotDoneIndexInvalid(String index) {
        commandBox.runCommand("notdone " + index);
        assertResultMessage(Messages.MESSAGE_INVALID_TASK_DISPLAYED_INDEX);
    }
}
```
###### /java/guitests/EditCommandTest.java
``` java
public class EditCommandTest extends TaskManagerGuiTest {

    @Test
    public void edit() throws Exception {
        // Edit Today Task with Tags
        commandBox.runCommand("edit T3 #lol #wp");
        Task taskToEdit = Task.createTask(td.todayListDeadline);
        taskToEdit.setTags(new UniqueTagList("lol", "wp"));
        todayList = TestUtil.replaceTaskFromList(todayList, taskToEdit, 2);

        assertTodayEditSuccess(taskToEdit, todayList, futureList, completedList);

        // Edit Future Task with Name and Tag
        commandBox.runCommand("edit F1 Find Bobby #child");
        taskToEdit = Task.createTask(td.futureListFloat);
        taskToEdit.setName(new Name("Find Bobby"));
        taskToEdit.setTags(new UniqueTagList("child"));
        futureList = TestUtil.replaceTaskFromList(futureList, taskToEdit, 0);

        assertFutureEditSuccess(taskToEdit, todayList, futureList, completedList);

        // Edit Completed Task, remove tags
        commandBox.runCommand("edit C1 #");
        taskToEdit = Task.createTask(td.completedListFloat);
        taskToEdit.setTags(new UniqueTagList());
        completedList = TestUtil.replaceTaskFromList(completedList, taskToEdit, 0);

        assertCompletedEditSuccess(taskToEdit, todayList, futureList, completedList);
    }

    @Test
    public void edit_fail() throws Exception {
        // ~~~ Failure Tests ~~~
        commandBox.runCommand("edit Bobby");
        assertResultMessage(Messages.MESSAGE_INVALID_COMMAND_FORMAT);

        commandBox.runCommand("edit F8 Bobby");
        assertResultMessage(Messages.MESSAGE_INVALID_TASK_DISPLAYED_INDEX);

        commandBox.runCommand("edit F1");
        assertResultMessage(Messages.MESSAGE_INVALID_COMMAND_FORMAT);

        commandBox.runCommand("edit F1 " + td.todayListFloat.getName().toString() + " #helo");
        assertResultMessage(EditCommand.MESSAGE_DUPLICATE_TASK);

        commandBox.runCommand("edit F1 *&");
        assertResultMessage(Name.MESSAGE_NAME_CONSTRAINTS);

        commandBox.runCommand("edit F1 #*&");
        assertResultMessage(Messages.MESSAGE_INVALID_COMMAND_FORMAT);
    }

    @Test
    public void edit_findThenEdit_success() throws Exception {
        commandBox.runCommand("find do");
        commandBox.runCommand("edit T2 Dancing time #party #fun");
        commandBox.runCommand("list");
        Task taskToEdit = Task.createTask(td.todayListToday);
        taskToEdit.setName(new Name("Dancing time"));
        taskToEdit.setTags(new UniqueTagList("party", "fun"));
        todayList = TestUtil.replaceTaskFromList(todayList, taskToEdit, 4);

        assertTodayEditSuccess(taskToEdit, todayList, futureList, completedList);

    }

    // ----- Helper -----

    private void assertTodayEditSuccess(Task taskToEdit, Task[] expectedTodayList, Task[] expectedFutureList,
            Task[] expectedCompletedList) throws IllegalArgumentException, IllegalValueException {
        TaskCardHandle addedCard = todayTaskListPanel.navigateToTask(taskToEdit.getName().toString());
        assertMatching(taskToEdit, addedCard);

        assertAllListsMatching(expectedTodayList, expectedFutureList, expectedCompletedList);
    }

    private void assertFutureEditSuccess(Task taskToEdit, Task[] expectedTodayList, Task[] expectedFutureList,
            Task[] expectedCompletedList) throws IllegalArgumentException, IllegalValueException {
        TaskCardHandle addedCard = futureTaskListPanel.navigateToTask(taskToEdit.getName().toString());
        assertMatching(taskToEdit, addedCard);

        assertAllListsMatching(expectedTodayList, expectedFutureList, expectedCompletedList);
    }

    private void assertCompletedEditSuccess(Task taskToEdit, Task[] expectedTodayList, Task[] expectedFutureList,
            Task[] expectedCompletedList) throws IllegalArgumentException, IllegalValueException {
        commandBox.runCommand("listcompleted");
        TaskCardHandle addedCard = completedTaskListPanel.navigateToTask(taskToEdit.getName().toString());
        assertMatching(taskToEdit, addedCard);
        commandBox.runCommand("list");

        assertAllListsMatching(expectedTodayList, expectedFutureList, expectedCompletedList);
    }

}
```
###### /java/seedu/today/logic/LogicManagerTest.java
``` java
    @Test
    public void execute_done_invalidArgsFormat() {
        String expectedMessage = Messages.MESSAGE_INVALID_TASK_DISPLAYED_INDEX;
        assertCommandFailure("done ", expectedMessage);
    }

    @Test
    public void execute_doneIndexNotFound_errorMessageShown() throws Exception {
        assertIndexNotFoundBehaviorForCommand("done");
    }

    @Test
    public void execute_done_valid() throws Exception {
        Task doneTask = Task.createTask(td.futureListFloat);
        doneTask.setDone(true);
        expectedAB.updateTask(5, doneTask);

        assertCommandSuccess("done F1", String.format(DoneCommand.MESSAGE_DONE_TASK_SUCCESS, doneTask), expectedAB,
                expectedAB.getTaskList());
    }

    // ------------ Not Done Command ---------------

    @Test
    public void execute_notdone_invalidArgsFormat() {
        String expectedMessage = String.format(Messages.MESSAGE_INVALID_TASK_DISPLAYED_INDEX);
        assertCommandFailure("notdone ", expectedMessage);
    }

    @Test
    public void execute_notdoneIndexNotFound_errorMessageShown() throws Exception {
        assertIndexNotFoundBehaviorForCommand("notdone");
    }

    @Test
    public void execute_notdone_valid() throws Exception {
        Task notDoneTask = Task.createTask(td.completedListFloat);
        notDoneTask.setDone(false);
        expectedAB.updateTask(8, notDoneTask);

        assertCommandSuccess("notdone C1", String.format(NotDoneCommand.MESSAGE_NOTDONE_TASK_SUCCESS, notDoneTask),
                expectedAB, expectedAB.getTaskList());
    }

    // -------------- Edit Command ------------------

```
###### /java/seedu/today/logic/LogicManagerTest.java
``` java
    @Test
    public void execute_editOnlyIndex_invalid() {
        String expectedMessage = MESSAGE_INVALID_COMMAND_FORMAT;
        assertCommandFailure("edit F1", expectedMessage);
    }

    @Test
    public void execute_editNoIndex_invalid() {
        String expectedMessage = MESSAGE_INVALID_COMMAND_FORMAT;
        assertCommandFailure("edit task2 #well", expectedMessage);
    }

```
###### /java/seedu/today/logic/LogicManagerTest.java
``` java
    // ----------------- Today Command ------------------

    @Test
    public void execute_today_invalidArgsFormat() {
        String expectedMessage = Messages.MESSAGE_INVALID_TASK_DISPLAYED_INDEX;
        assertCommandFailure("today ", expectedMessage);
    }

    @Test
    public void execute_todayIndexNotFound_errorMessageShown() throws Exception {
        assertIndexNotFoundBehaviorForCommand("today");
    }

    @Test
    public void execute_today_valid() throws Exception {
        Task taskToToday = Task.createTask(td.futureListDeadline);
        taskToToday.setToday(true);
        expectedAB.updateTask(6, taskToToday);

        assertCommandSuccess("today F2", String.format(TodayCommand.MESSAGE_TODAY_TASK_SUCCESS, td.futureListDeadline),
                expectedAB, expectedAB.getTaskList());
    }

    // ------------------- Not Today -----------------------

    @Test
    public void execute_notToday_invalidArgsFormat() {
        String expectedMessage = Messages.MESSAGE_INVALID_TASK_DISPLAYED_INDEX;
        assertCommandFailure("nottoday ", expectedMessage);
    }

    @Test
    public void execute_notTodayIndexNotFound_errorMessageShown() throws Exception {
        assertIndexNotFoundBehaviorForCommand("nottoday");
    }

    @Test
    public void execute_notToday_valid() throws Exception {
        Task taskToNotToday = Task.createTask(td.todayListFloat);
        taskToNotToday.setToday(false);
        expectedAB.updateTask(1, taskToNotToday);

        assertCommandSuccess("nottoday T2",
                String.format(NotTodayCommand.MESSAGE_NOTTODAY_TASK_SUCCESS, taskToNotToday), expectedAB,
                expectedAB.getTaskList());
    }

    // --------------- Find Command -------------------

```
###### /java/seedu/today/logic/LogicManagerTest.java
``` java
    @Test
    public void execute_renametag_invalidArgsFormat() {
        String expectedMessage = MESSAGE_INVALID_COMMAND_FORMAT;
        assertCommandFailure("renametag ", expectedMessage);
    }

    @Test
    public void execute_renametag_onlyMatchesFullWordsCorrectCaseInTags() throws Exception {
        Task taskToRenameTag1 = Task.createTask(td.todayListFloat);
        Task taskToRenameTag2 = Task.createTask(td.completedListFloat);
        UniqueTagList replacementTags = new UniqueTagList();
        replacementTags.add(new Tag("lol"));
        taskToRenameTag1.setTags(replacementTags);
        taskToRenameTag2.setTags(replacementTags);
        expectedAB.updateTask(1, taskToRenameTag1);
        expectedAB.updateTask(8, taskToRenameTag2);

        assertCommandSuccess("renametag project lol",
                String.format(RenameTagCommand.MESSAGE_RENAME_TAG_SUCCESS, "project", "lol"), expectedAB,
                expectedAB.getTaskList());
    }

    // ---------------- Delete Tag Command ----------------------

    @Test
    public void execute_deletetag_invalidArgsFormat() {
        String expectedMessage = MESSAGE_INVALID_COMMAND_FORMAT;
        assertCommandFailure("deletetag ", expectedMessage);
    }

    @Test
    public void execute_deletetag_onlyMatchesFullWordsAndCorrectCaseInTags() throws Exception {
        Task taskToRenameTag1 = Task.createTask(td.todayListFloat);
        Task taskToRenameTag2 = Task.createTask(td.completedListFloat);
        UniqueTagList replacementTags = new UniqueTagList();
        taskToRenameTag1.setTags(replacementTags);
        taskToRenameTag2.setTags(replacementTags);
        expectedAB.updateTask(1, taskToRenameTag1);
        expectedAB.updateTask(8, taskToRenameTag2);

        assertCommandSuccess("deletetag project", String.format(DeleteTagCommand.MESSAGE_DELETE_TAG_SUCCESS, "project"),
                expectedAB, expectedAB.getTaskList());
    }

    // --------------------- SaveTo Command ----------------------
```
