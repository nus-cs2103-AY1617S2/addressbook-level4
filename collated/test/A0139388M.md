# A0139388M
###### /java/seedu/today/logic/LogicManagerTest.java
``` java
    @Test
    public void execute_saveTo_canonicalSameDirectory() throws Exception {
        File tmFile = new File(".", SaveToCommand.TASK_MANAGER_FILE_NAME);
        assertCommandSuccess("saveto .", String.format(SaveToCommand.MESSAGE_SUCCESS, tmFile.getCanonicalPath()),
                expectedAB, expectedAB.getTaskList());
        tmFile.delete();
    }

    @Test
    public void execute_saveTo_canonicalParentDirectory() throws Exception {
        File tmFile = new File("..", SaveToCommand.TASK_MANAGER_FILE_NAME);
        assertCommandSuccess("saveto ..", String.format(SaveToCommand.MESSAGE_SUCCESS, tmFile.getCanonicalPath()),
                expectedAB, expectedAB.getTaskList());
        tmFile.delete();
    }

    @Test
    public void execute_saveTo_canonicalSubDirectory() throws Exception {
        File tmFile = new File("testSubDir", SaveToCommand.TASK_MANAGER_FILE_NAME);
        assertCommandSuccess("saveto testSubDir",
                String.format(SaveToCommand.MESSAGE_SUCCESS, tmFile.getCanonicalPath()), expectedAB,
                expectedAB.getTaskList());
        tmFile.delete();
        tmFile.getParentFile().delete();
    }

    @Test
    public void execute_saveTo_absoluteSameDirectory() throws Exception {
        File tmFile = new File(".", SaveToCommand.TASK_MANAGER_FILE_NAME);
        assertCommandSuccess("saveto " + tmFile.getParentFile().getAbsolutePath(),
                String.format(SaveToCommand.MESSAGE_SUCCESS, tmFile.getCanonicalPath()), expectedAB,
                expectedAB.getTaskList());
        tmFile.delete();
    }

    @Test
    public void execute_saveTo_absoluteParentDirectory() throws Exception {
        File tmFile = new File("..", SaveToCommand.TASK_MANAGER_FILE_NAME);
        assertCommandSuccess("saveto " + tmFile.getParentFile().getAbsolutePath(),
                String.format(SaveToCommand.MESSAGE_SUCCESS, tmFile.getCanonicalPath()), expectedAB,
                expectedAB.getTaskList());
        tmFile.delete();
    }

    @Test
    public void execute_saveTo_absoluteSubDirectory() throws Exception {
        File tmFile = new File("testSubDir", SaveToCommand.TASK_MANAGER_FILE_NAME);
        assertCommandSuccess("saveto " + tmFile.getParentFile().getAbsolutePath(),
                String.format(SaveToCommand.MESSAGE_SUCCESS, tmFile.getCanonicalPath()), expectedAB,
                expectedAB.getTaskList());
        tmFile.delete();
        tmFile.getParentFile().delete();
    }

    @Test
    public void execute_saveTo_noWritePermissions() throws Exception {
        File noWritePermissionsFile = new File("noPermissions", SaveToCommand.TASK_MANAGER_FILE_NAME);
        if (noWritePermissionsFile.setReadOnly()) {
            assertCommandFailure("saveto " + noWritePermissionsFile.getParentFile().getAbsolutePath(),
                    String.format(SaveToCommand.MESSAGE_WRITE_FILE_ERROR, noWritePermissionsFile.getAbsolutePath()));
            noWritePermissionsFile.getParentFile().delete();
        }
    }

    @Test
    public void execute_saveTo_invalidFolderName() throws Exception {
        File invalidFolderNameFile = new File("////?!", SaveToCommand.TASK_MANAGER_FILE_NAME);
        assertCommandFailure("saveto " + invalidFolderNameFile.getParentFile().getAbsolutePath(),
                String.format(SaveToCommand.MESSAGE_WRITE_FILE_ERROR, invalidFolderNameFile.getAbsolutePath()));
    }

    // ----------------- Export Command ----------------------

    @Test
    public void execute_export_canonicalSameDirectory() throws Exception {
        File tmFile = new File(".", ExportCommand.TASK_MANAGER_FILE_NAME);
        assertCommandSuccess("export .", String.format(ExportCommand.MESSAGE_SUCCESS, tmFile.getCanonicalPath()),
                expectedAB, expectedAB.getTaskList());
        tmFile.delete();
    }

    @Test
    public void execute_export_canonicalParentDirectory() throws Exception {
        File tmFile = new File("..", ExportCommand.TASK_MANAGER_FILE_NAME);
        assertCommandSuccess("export ..", String.format(ExportCommand.MESSAGE_SUCCESS, tmFile.getCanonicalPath()),
                expectedAB, expectedAB.getTaskList());
        tmFile.delete();
    }

    @Test
    public void execute_export_canonicalSubDirectory() throws Exception {
        File tmFile = new File("testSubDir", ExportCommand.TASK_MANAGER_FILE_NAME);
        assertCommandSuccess("export testSubDir",
                String.format(ExportCommand.MESSAGE_SUCCESS, tmFile.getCanonicalPath()), expectedAB,
                expectedAB.getTaskList());
        tmFile.delete();
        tmFile.getParentFile().delete();
    }

    @Test
    public void execute_export_absoluteSameDirectory() throws Exception {
        File tmFile = new File(".", ExportCommand.TASK_MANAGER_FILE_NAME);
        assertCommandSuccess("export " + tmFile.getParentFile().getAbsolutePath(),
                String.format(ExportCommand.MESSAGE_SUCCESS, tmFile.getCanonicalPath()), expectedAB,
                expectedAB.getTaskList());
        tmFile.delete();
    }

    @Test
    public void execute_export_absoluteParentDirectory() throws Exception {
        File tmFile = new File("..", ExportCommand.TASK_MANAGER_FILE_NAME);
        assertCommandSuccess("export " + tmFile.getParentFile().getAbsolutePath(),
                String.format(ExportCommand.MESSAGE_SUCCESS, tmFile.getCanonicalPath()), expectedAB,
                expectedAB.getTaskList());
        tmFile.delete();
    }

    @Test
    public void execute_export_absoluteSubDirectory() throws Exception {
        File tmFile = new File("testSubDir", ExportCommand.TASK_MANAGER_FILE_NAME);
        assertCommandSuccess("export " + tmFile.getParentFile().getAbsolutePath(),
                String.format(ExportCommand.MESSAGE_SUCCESS, tmFile.getCanonicalPath()), expectedAB,
                expectedAB.getTaskList());
        tmFile.delete();
        tmFile.getParentFile().delete();
    }

    @Test
    public void execute_export_noWritePermissions() throws Exception {
        File noWritePermissionsFile = new File("noPermissions", ExportCommand.TASK_MANAGER_FILE_NAME);
        if (noWritePermissionsFile.setReadOnly()) {
            assertCommandFailure("export " + noWritePermissionsFile.getParentFile().getAbsolutePath(),
                    String.format(ExportCommand.MESSAGE_WRITE_FILE_ERROR, noWritePermissionsFile.getAbsolutePath()));
            noWritePermissionsFile.getParentFile().delete();
        }
    }

    @Test
    public void execute_export_invalidFileName() throws Exception {
        File invalidFileNameFile = new File("////?!", ExportCommand.TASK_MANAGER_FILE_NAME);
        assertCommandFailure("export " + invalidFileNameFile.getParentFile().getAbsolutePath(),
                String.format(ExportCommand.MESSAGE_WRITE_FILE_ERROR, invalidFileNameFile.getAbsolutePath()));
    }

    // --------------------- UseThisCommand -----------------------

    @Test
    public void execute_useThis_absoluteSubDirectory() throws Exception {
        File tmFile = new File("testSubDir", UseThisCommand.TASK_MANAGER_FILE_NAME);
        FileUtil.createFile(tmFile);
        assertCommandSuccess("usethis " + tmFile.getParentFile().getAbsolutePath(),
                String.format(UseThisCommand.MESSAGE_SUCCESS, tmFile.getCanonicalPath()), new TaskManager(),
                Collections.emptyList());
        tmFile.delete();
        tmFile.getParentFile().delete();
    }

    @Test
    public void execute_useThis_invalidFolderName() throws Exception {
        File invalidFolderNameFile = new File("////?!", UseThisCommand.TASK_MANAGER_FILE_NAME);
        assertCommandFailure("usethis " + invalidFolderNameFile.getParentFile().getAbsolutePath(),
                String.format(UseThisCommand.MESSAGE_FILE_MISSING_ERROR, invalidFolderNameFile.getAbsolutePath()));
    }

    // ------------------------- Import Command ------------------------

    @Test
    public void execute_import_absoluteSubDirectory() throws Exception {
        File tmFile = new File("testSubDir", ImportCommand.TASK_MANAGER_FILE_NAME);

        // add adam to list

        Task toBeAdded = Task.createTask(td.extraDeadline);
        expectedAB.addTask(toBeAdded);

        // verify added
        String addCommand = TestUtil.makeAddCommandString(toBeAdded);
        assertCommandSuccess(addCommand, String.format(AddCommand.MESSAGE_SUCCESS, toBeAdded), expectedAB,
                expectedAB.getTaskList());

        // no difference after importing empty file
        FileUtil.createFile(tmFile);
        assertCommandSuccess("import " + tmFile.getParentFile().getAbsolutePath(),
                String.format(ImportCommand.MESSAGE_SUCCESS, tmFile.getCanonicalPath()), expectedAB,
                expectedAB.getTaskList());

        // cleanup
        tmFile.delete();
        tmFile.getParentFile().delete();
    }

    @Test
    public void execute_import_invalidFolderName() throws Exception {
        File invalidFolderNameFile = new File("////?!", ImportCommand.TASK_MANAGER_FILE_NAME);
        assertCommandFailure("import " + invalidFolderNameFile.getParentFile().getAbsolutePath(),
                String.format(UseThisCommand.MESSAGE_FILE_MISSING_ERROR, invalidFolderNameFile.getAbsolutePath()));
    }

    // ------------------- Undo Command ---------------------

    @Test
    public void execute_undoAdd_successful() throws Exception {
        // add adam to list
        Task toBeAdded = Task.createTask(td.extraFloat);
        expectedAB.addTask(toBeAdded);

        // verify added
        String addCommand = TestUtil.makeAddCommandString(toBeAdded);
        assertCommandSuccess(addCommand, String.format(AddCommand.MESSAGE_SUCCESS, toBeAdded), expectedAB,
                expectedAB.getTaskList());

        // undo command
        expectedAB.removeTask(toBeAdded);
        assertCommandSuccess("undo", String.format(UndoCommand.MESSAGE_SUCCESS, addCommand), expectedAB,
                expectedAB.getTaskList());
    }

    @Test
    public void execute_undoSave_successful() throws Exception {
        // save to same directory
        File tmFile = new File(".", SaveToCommand.TASK_MANAGER_FILE_NAME);
        String commandText = "saveto " + tmFile.getParentFile().getAbsolutePath();
        assertCommandSuccess(commandText, String.format(SaveToCommand.MESSAGE_SUCCESS, tmFile.getCanonicalPath()),
                expectedAB, expectedAB.getTaskList());
        assertTrue(FileUtil.isFileExists(tmFile));

        // undo command
        assertCommandSuccess("undo", String.format(UndoCommand.MESSAGE_SUCCESS, commandText), expectedAB,
                expectedAB.getTaskList());
        assertFalse(FileUtil.isFileExists(tmFile));
    }

    @Test
    public void execute_undoExport_successful() throws Exception {
        // save to same directory
        File tmFile = new File(".", SaveToCommand.TASK_MANAGER_FILE_NAME);
        String commandText = "export " + tmFile.getParentFile().getAbsolutePath();
        assertCommandSuccess(commandText, String.format(ExportCommand.MESSAGE_SUCCESS, tmFile.getCanonicalPath()),
                expectedAB, expectedAB.getTaskList());
        assertTrue(FileUtil.isFileExists(tmFile));

        // undo command
        assertCommandSuccess("undo", String.format(UndoCommand.MESSAGE_SUCCESS, commandText), expectedAB,
                expectedAB.getTaskList());
        assertFalse(FileUtil.isFileExists(tmFile));
    }

    @Test
    public void execute_undo_nothingToUndo() throws Exception {
        // undo command
        assertCommandFailure("undo", UndoCommand.MESSAGE_NO_PREV_COMMAND);
    }

    // ----------------- Redo Command -------------------------

    @Test
    public void execute_undoAddRedo_successful() throws Exception {
        // add adam to list
        Task toBeAdded = Task.createTask(td.extraDeadline);
        expectedAB.addTask(toBeAdded);

        // verify added
        String addCommand = TestUtil.makeAddCommandString(toBeAdded);
        assertCommandSuccess(addCommand, String.format(AddCommand.MESSAGE_SUCCESS, toBeAdded), expectedAB,
                expectedAB.getTaskList());

        // undo command
        expectedAB.removeTask(toBeAdded);
        assertCommandSuccess("undo", String.format(UndoCommand.MESSAGE_SUCCESS, addCommand), expectedAB,
                expectedAB.getTaskList());

        // redo command
        expectedAB.addTask(toBeAdded);
        assertCommandSuccess("redo", String.format(AddCommand.MESSAGE_SUCCESS, toBeAdded), expectedAB,
                expectedAB.getTaskList());

    }

    @Test
    public void execute_undoSaveRedo_successful() throws Exception {
        // save to same directory
        File tmFile = new File(".", SaveToCommand.TASK_MANAGER_FILE_NAME);
        String commandText = "saveto " + tmFile.getParentFile().getAbsolutePath();
        assertCommandSuccess(commandText, String.format(SaveToCommand.MESSAGE_SUCCESS, tmFile.getCanonicalPath()),
                expectedAB, expectedAB.getTaskList());
        assertTrue(FileUtil.isFileExists(tmFile));

        // undo command
        assertCommandSuccess("undo", String.format(UndoCommand.MESSAGE_SUCCESS, commandText), expectedAB,
                expectedAB.getTaskList());
        assertFalse(FileUtil.isFileExists(tmFile));

        // redo command
        assertCommandSuccess("redo", String.format(SaveToCommand.MESSAGE_SUCCESS, tmFile.getCanonicalPath()),
                expectedAB, expectedAB.getTaskList());
        assertTrue(FileUtil.isFileExists(tmFile));
        tmFile.delete();
    }
}
```
