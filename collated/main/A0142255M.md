# A0142255M
###### \java\seedu\tache\commons\events\ui\TaskListTypeChangedEvent.java
``` java
package seedu.tache.commons.events.ui;

import seedu.tache.commons.events.BaseEvent;

/**
 * Indicates that the task list type is changed.
 */
public class TaskListTypeChangedEvent extends BaseEvent {

    public final String newTaskListType;

    public TaskListTypeChangedEvent(String newTaskListType) {
        this.newTaskListType = newTaskListType;
    }

    public String getTaskListType() {
        return newTaskListType;
    }

    @Override
    public String toString() {
        return this.getClass().getSimpleName();
    }

}
```
###### \java\seedu\tache\logic\Logic.java
``` java
    /**
     * Returns type of filtered task list in a String
     */
    String getFilteredTaskListType();
}
```
###### \java\seedu\tache\logic\LogicManager.java
``` java
    @Override
    public String getFilteredTaskListType() {
        return model.getFilteredTaskListType();
    }

}
```
###### \java\seedu\tache\logic\parser\CliSyntax.java
``` java
    public static final String TIMED_FILTER = "timed";
    public static final String FLOATING_FILTER = "floating";
```
###### \java\seedu\tache\model\Model.java
``` java
    /** Updates the filter of the filtered task list to show all uncompleted tasks */
    void updateFilteredListToShowTimed();

    /** Updates the filter of the filtered task list to show all completed tasks */
    void updateFilteredListToShowFloating();

    /** Returns the filtered task list type as a {@code String} */
    String getFilteredTaskListType();

}
```
###### \java\seedu\tache\model\ModelManager.java
``` java
    public static final String ALL_TASK_LIST_TYPE = "all tasks";
    public static final String COMPLETED_TASK_LIST_TYPE = "completed tasks";
    public static final String UNCOMPLETED_TASK_LIST_TYPE = "uncompleted tasks";
    public static final String TIMED_TASK_LIST_TYPE = "timed tasks";
    public static final String FLOATING_TASK_LIST_TYPE = "floating tasks";
```
###### \java\seedu\tache\model\ModelManager.java
``` java
    private String filteredTaskListType = ALL_TASK_LIST_TYPE;
```
###### \java\seedu\tache\model\ModelManager.java
``` java
    @Override
    public synchronized void addTask(Task task) throws DuplicateTaskException {
        taskManager.addTask(task);
        updateFilteredTaskListType(ALL_TASK_LIST_TYPE);
        indicateTaskManagerChanged();
    }
```
###### \java\seedu\tache\model\ModelManager.java
``` java
    @Override
    public void updateFilteredListToShowTimed() {
        updateFilteredTaskList(new PredicateExpression(new TimedQualifier(true)));
        updateFilteredTaskListType(TIMED_TASK_LIST_TYPE);
    }

    @Override
    public void updateFilteredListToShowFloating() {
        updateFilteredTaskList(new PredicateExpression(new TimedQualifier(false)));
        updateFilteredTaskListType(FLOATING_TASK_LIST_TYPE);
    }
```
###### \java\seedu\tache\model\ModelManager.java
``` java
    @Override
    public String getFilteredTaskListType() {
        return filteredTaskListType;
    }

    private void updateFilteredTaskListType(String newFilteredTaskListType) {
        if (!filteredTaskListType.equals(newFilteredTaskListType)) {
            raise(new TaskListTypeChangedEvent(newFilteredTaskListType));
        }
        filteredTaskListType = newFilteredTaskListType;
    }
```
###### \java\seedu\tache\model\ModelManager.java
``` java
    private class TimedQualifier implements Qualifier {
        private boolean isTimed;

        TimedQualifier(boolean isTimed) {
            this.isTimed = isTimed;
        }

        @Override
        public boolean run(ReadOnlyTask task) {
            if (isTimed) {
                return task.getTimedStatus();
            } else {
                return !task.getTimedStatus();
            }
        }

        @Override
        public String toString() {
            return "timed=" + isTimed;
        }
    }

```
###### \java\seedu\tache\model\task\DateTime.java
``` java
    public String getDateTimeForFullCalendar() {
        SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss");
        return sdf.format(date);
    }

   /* @Override
    public boolean equals(Object other) {
        return other == this // short circuit if same object
                || (other instanceof Date // instanceof handles nulls
                && this.time.equals(((Date) other).time)); // state check
    }*/

    /*@Override
    public int hashCode() {
        return (startDate.hashCode() && endDate.hashCode());
    }*/

}
```
###### \java\seedu\tache\model\task\Task.java
``` java
    @Override
    public boolean getTimedStatus() {
        return isTimed;
    }

    public void setTimedStatus(boolean isTimed) {
        this.isTimed = isTimed;
    }

```
###### \java\seedu\tache\ui\CalendarPanel.java
``` java
    private void loadCalendar(ObservableList<ReadOnlyTask> taskList) {
        String calendarURL = MainApp.class.getResource("/html/calendar.html").toExternalForm();
        WebEngine engine = calendar.getEngine();
        engine.load(calendarURL);
        for (ReadOnlyTask task : taskList) {
            if (!task.getStartDateTime().isPresent()) {
                continue;
            }
            engine.executeScript(getLoadTaskExecuteScript(task));
        }
    }

    private String getLoadTaskExecuteScript(ReadOnlyTask task) {
        String title = task.getName().toString();
        String start = task.getStartDateTime().get().getDateTimeForFullCalendar();
        String end = "0"; // invalid format of datetime
        Optional<DateTime> endDateTime = task.getEndDateTime();
        if (task.getEndDateTime().isPresent()) {
            end = endDateTime.get().getDateTimeForFullCalendar();
        }
        String isActive = String.valueOf(task.getActiveStatus());
        return "add_event('" + title + "', '" + start + "', '" + end + "', '" + isActive + "')";

    }

    @Subscribe
    public void handleTaskManagerChangedEvent(TaskManagerChangedEvent event) {
        ObservableList<ReadOnlyTask> taskList = event.data.getTaskList();
        WebEngine engine = calendar.getEngine();
        engine.getLoadWorker().stateProperty().addListener((obs, oldState, newState) -> {
            if (newState == Worker.State.SUCCEEDED) {
                calendar.getEngine().executeScript("'remove_all'");
            }
        });
        loadCalendar(taskList);
    }
```
###### \java\seedu\tache\ui\MainWindow.java
``` java
    @FXML
    private AnchorPane taskListTypePlaceholder;

    @FXML
    private AnchorPane taskCountPlaceholder;
```
###### \java\seedu\tache\ui\MainWindow.java
``` java
    void fillInnerParts() {
        calendarPanel = new CalendarPanel(getCalendarPlaceholder(), logic.getFilteredTaskList());
        taskListPanel = new TaskListPanel(getTaskListPlaceholder(), logic.getFilteredTaskList());
        new TaskListType(getTaskListTypePlaceholder(), logic.getFilteredTaskListType());
        new TaskCount(getTaskCountPlaceholder(), logic);
        new ResultDisplay(getResultDisplayPlaceholder());
        new StatusBarFooter(getStatusbarPlaceholder(), config.getTaskManagerFilePath());
        new CommandBox(getCommandBoxPlaceholder(), logic);
    }

    private AnchorPane getCalendarPlaceholder() {
        return calendarPlaceholder;
    }
```
###### \java\seedu\tache\ui\MainWindow.java
``` java
    private AnchorPane getTaskCountPlaceholder() {
        return taskCountPlaceholder;
    }

    private AnchorPane getTaskListTypePlaceholder() {
        return taskListTypePlaceholder;
    }
```
###### \java\seedu\tache\ui\MainWindow.java
``` java
    void viewTaskEvent(ReadOnlyTask task) {
        //browserPanel.viewEvent(task);
    }
```
###### \java\seedu\tache\ui\TaskCount.java
``` java
package seedu.tache.ui;

import java.util.logging.Logger;

import com.google.common.eventbus.Subscribe;

import javafx.collections.ObservableList;
import javafx.fxml.FXML;
import javafx.scene.control.Label;
import javafx.scene.layout.AnchorPane;
import javafx.scene.layout.Region;
import seedu.tache.commons.core.LogsCenter;
import seedu.tache.commons.events.model.TaskManagerChangedEvent;
import seedu.tache.commons.util.FxViewUtil;
import seedu.tache.logic.Logic;
import seedu.tache.model.task.ReadOnlyTask;

/**
 * Count of timed and floating tasks.
 */
public class TaskCount extends UiPart<Region> {
    private static final Logger logger = LogsCenter.getLogger(TaskCount.class);
    private static final String FXML = "TaskCount.fxml";

    @FXML
    private Label timedTaskCount;
    @FXML
    private Label floatingTaskCount;

    public TaskCount(AnchorPane taskCountPlaceholder, Logic logic) {
        super(FXML);
        setTimedTaskCount(logic.getFilteredTaskList());
        setFloatingTaskCount(logic.getFilteredTaskList());
        addToPlaceholder(taskCountPlaceholder);
        registerAsAnEventHandler(this);
    }

    private void addToPlaceholder(AnchorPane placeHolder) {
        FxViewUtil.applyAnchorBoundaryParameters(getRoot(), 0.0, 0.0, 0.0, 0.0);
        placeHolder.getChildren().add(getRoot());
    }

```
###### \java\seedu\tache\ui\TaskCount.java
``` java
    private void setTimedTaskCount(ObservableList<ReadOnlyTask> taskList) {
        String count = getTimedTaskCount(taskList);
        this.timedTaskCount.setText(count);
    }

    private String getTimedTaskCount(ObservableList<ReadOnlyTask> taskList) {
        int count = 0;
        for (ReadOnlyTask task : taskList) {
            if (task.getTimedStatus() == true) {
                count++;
            }
        }
        return Integer.toString(count);
    }

    private void setFloatingTaskCount(ObservableList<ReadOnlyTask> taskList) {
        String count = getFloatingTaskCount(taskList);
        this.floatingTaskCount.setText(count);
    }

    private String getFloatingTaskCount(ObservableList<ReadOnlyTask> taskList) {
        int count = 0;
        for (ReadOnlyTask task : taskList) {
            if (task.getTimedStatus() == false) {
                count++;
            }
        }
        return Integer.toString(count);
    }

    @Subscribe
    public void handleTaskManagerChangedEvent(TaskManagerChangedEvent event) {
        ObservableList<ReadOnlyTask> taskList = event.data.getTaskList();
        String oldTimedCount = this.timedTaskCount.getText();
        String newTimedCount = this.getTimedTaskCount(taskList);
        if (oldTimedCount != newTimedCount) {
            this.timedTaskCount.setText(newTimedCount);
            logger.fine("Timed task list count changed to : '" + newTimedCount + "'");
        }
        String oldFloatingCount = this.floatingTaskCount.getText();
        String newFloatingCount = this.getFloatingTaskCount(taskList);
        if (oldFloatingCount != newFloatingCount) {
            this.floatingTaskCount.setText(newFloatingCount);
            logger.fine("Floating task list count changed to : '" + newFloatingCount + "'");
        }
    }

}
```
###### \java\seedu\tache\ui\TaskListType.java
``` java
package seedu.tache.ui;

import java.util.logging.Logger;

import com.google.common.eventbus.Subscribe;

import javafx.fxml.FXML;
import javafx.scene.control.Label;
import javafx.scene.layout.AnchorPane;
import javafx.scene.layout.Region;
import seedu.tache.commons.core.LogsCenter;
import seedu.tache.commons.events.ui.TaskListTypeChangedEvent;
import seedu.tache.commons.util.FxViewUtil;

/**
 * Panel containing: type of tasks shown in task list, no. of detailed tasks and no. of floating tasks.
 */
public class TaskListType extends UiPart<Region> {
    private final Logger logger = LogsCenter.getLogger(TaskListType.class);
    private static final String FXML = "TaskListType.fxml";

    @FXML
    private Label taskListType;

    public TaskListType(AnchorPane taskListTypePlaceholder, String typeOfTasks) {
        super(FXML);
        taskListType.setText(typeOfTasks);
        addToPlaceholder(taskListTypePlaceholder);
        registerAsAnEventHandler(this);
    }

    private void addToPlaceholder(AnchorPane placeHolder) {
        FxViewUtil.applyAnchorBoundaryParameters(getRoot(), 0.0, 0.0, 0.0, 0.0);
        placeHolder.getChildren().add(getRoot());
    }

    @Subscribe
    public void handleTaskListTypeChangedEvent(TaskListTypeChangedEvent event) {
        String oldTaskListType = this.taskListType.getText();
        String newTaskListType = event.getTaskListType();
        if (oldTaskListType != newTaskListType) {
            this.taskListType.setText(newTaskListType);
            logger.fine("Task list type changed to : '" + newTaskListType + "'");
        }
    }

}
```
###### \resources\view\DarkTheme.css
``` css
.task-list-type {
    -fx-font-size: 15pt;
    -fx-font-family: "Segoe UI Light";
    -fx-text-fill: white;
    -fx-opacity: 0.9;
    -fx-alignment: center;
}
```
###### \resources\view\MainWindow.fxml
``` fxml
      <SplitPane id="splitPane" fx:id="splitPane" dividerPositions="0.3" VBox.vgrow="ALWAYS">
         <items>
            <SplitPane dividerPositions="0.3" maxWidth="270.0" orientation="VERTICAL">
              <items>
                <AnchorPane maxHeight="90.0">
                     <children>
                      <AnchorPane fx:id="taskListTypePlaceholder" minWidth="180.0" AnchorPane.leftAnchor="0.0" AnchorPane.topAnchor="0.0">
                           <padding>
                              <Insets bottom="5.0" left="10.0" right="10.0" top="5.0" />
                           </padding>
                        </AnchorPane>
                      <AnchorPane fx:id="taskCountPlaceholder" minHeight="90.0" maxWidth="80.0" prefWidth="80.0" AnchorPane.rightAnchor="0.0" AnchorPane.topAnchor="0.0">
                           <padding>
                              <Insets bottom="5.0" left="10.0" right="10.0" top="5.0" />
                           </padding>
                        </AnchorPane>
                     </children>
                  </AnchorPane>
                <AnchorPane minWidth="270.0" prefWidth="270.0">
                     <children>
                        <VBox fx:id="taskList" AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0" AnchorPane.topAnchor="0.0">
                            <padding>
                                <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
                            </padding>
                           <children>
                              <AnchorPane fx:id="taskListPanelPlaceholder" VBox.vgrow="ALWAYS" />
                           </children>
                        </VBox>
                     </children>
                  </AnchorPane>
              </items>
            </SplitPane>
            <AnchorPane fx:id="calendarPlaceholder" minWidth="410.0" prefWidth="410.0">
```
###### \resources\view\TaskCount.fxml
``` fxml

<?import javafx.scene.control.Label?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.AnchorPane?>

<AnchorPane maxWidth="50.0" minHeight="70.0" prefHeight="70.0" prefWidth="50.0" xmlns="http://javafx.com/javafx/8.0.111" xmlns:fx="http://javafx.com/fxml/1">
   <children>
      <ImageView fitHeight="35.0" fitWidth="35.0" pickOnBounds="true" preserveRatio="true" AnchorPane.leftAnchor="0.0" AnchorPane.topAnchor="0.0">
         <image>
            <Image url="@../images/clock.png" />
         </image>
      </ImageView>
      <Label fx:id="timedTaskCount" minHeight="35.0" minWidth="15.0" prefHeight="35.0" prefWidth="15.0" textFill="WHITE" AnchorPane.rightAnchor="0.0" AnchorPane.topAnchor="0.0" />
      <ImageView fitHeight="35.0" fitWidth="35.0" pickOnBounds="true" preserveRatio="true" AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="0.0">
         <image>
            <Image url="@../images/task.png" />
         </image>
      </ImageView>
      <Label fx:id="floatingTaskCount" minHeight="35.0" minWidth="15.0" prefHeight="35.0" prefWidth="15.0" textFill="WHITE" AnchorPane.bottomAnchor="0.0" AnchorPane.rightAnchor="0.0" />
   </children>
</AnchorPane>
```
###### \resources\view\TaskListType.fxml
``` fxml

<?import java.net.URL?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.layout.AnchorPane?>

<AnchorPane fx:id="taskListTypePlaceholder" xmlns="http://javafx.com/javafx/8.0.111" xmlns:fx="http://javafx.com/fxml/1">
    <stylesheets>
        <URL value="@DarkTheme.css" />
        <URL value="@Extensions.css" />
    </stylesheets>
    <Label fx:id="taskListType" maxWidth="180" prefWidth="180" minHeight="80" styleClass="task-list-type" />
</AnchorPane>
```
