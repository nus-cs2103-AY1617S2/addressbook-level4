# A0131278H
###### /java/seedu/taskmanager/logic/commands/SortCommand.java
``` java
/**
 * Sorts tasks in the task manager according to start date or end date.
 */

public class SortCommand extends Command {
    public static final String COMMAND_WORD = "sort";
    public static final String SORT_KEYWORD_STARTDATE = "s/";
    public static final String SORT_KEYWORD_ENDDATE = "e/";
    public static final String SORT_KEYWORD_OTHERS = "other";

    public static final String MESSAGE_USAGE = COMMAND_WORD
            + ": Sorts tasks by either startdate or enddate in the task manager. " + "Examples: " + COMMAND_WORD
            + " s/ OR " + COMMAND_WORD + " e/.";

    public static final String MESSAGE_SUCCESS_START = "Tasks sorted by start dates.";
    public static final String MESSAGE_SUCCESS_END = "Tasks sorted by end dates.";
    public static final String MESSAGE_SUCCESS_INVALID_KEYWORD = "Input keyword is invalid. "
            + "Tasks sorted by end dates by default.";

    private final String sortCriterion;

    /**
     * @param sortCriterion
     *            the criterion to sort tasks by
     */
    public SortCommand(String sortCriterion) throws IllegalValueException {
        this.sortCriterion = sortCriterion;
    }

    @Override
    public CommandResult execute() throws CommandException {
        assert model != null;
        model.sortTasks(sortCriterion);
        model.updateFilteredListToShowAll();

        switch (sortCriterion) {
        case SORT_KEYWORD_STARTDATE:
            return new CommandResult(MESSAGE_SUCCESS_START);
        case SORT_KEYWORD_ENDDATE:
            return new CommandResult(MESSAGE_SUCCESS_END);
        default:
            return new CommandResult(MESSAGE_SUCCESS_INVALID_KEYWORD);
        }

    }
}
```
###### /java/seedu/taskmanager/logic/Logic.java
``` java
    /** Returns the filtered list of incomplete tasks */
    ObservableList<ReadOnlyTask> getFilteredToDoTaskList();

    /** Returns the filtered list of completed tasks */
    ObservableList<ReadOnlyTask> getFilteredDoneTaskList();

    /** Sets the current tab selected */
    void setSelectedTab(String text);
```
###### /java/seedu/taskmanager/logic/LogicManager.java
``` java
    @Override
    public ObservableList<ReadOnlyTask> getFilteredToDoTaskList() {
        return model.getFilteredToDoTaskList();
    }

    @Override
    public ObservableList<ReadOnlyTask> getFilteredDoneTaskList() {
        return model.getFilteredDoneTaskList();
    }

    @Override
    public void setSelectedTab(String selectedTab) {
        model.setSelectedTab(selectedTab);
    }
```
###### /java/seedu/taskmanager/logic/parser/SortCommandParser.java
``` java
/**
 * Parses input arguments and creates a new SortCommand object
 */

public class SortCommandParser {
    /**
     * Parses the given {@code String} of arguments in the context of the
     * SortCommand and returns an SortCommand object for execution.
     */
    public Command parse(String args) {
        assert args != null;
        final Matcher matcher = KEYWORDS_ARGS_FORMAT.matcher(args.trim());
        try {
            if (!matcher.matches()) {
                // sort by end dates if no keywords are entered
                return new SortCommand(SortCommand.SORT_KEYWORD_OTHERS);
            }

            // keywords delimited by whitespace
            final String[] keywords = matcher.group("keywords").split("\\s+");
            final List<String> keywordList = Arrays.asList(keywords);

            // only the first keyword is processed
            return new SortCommand(keywordList.get(0));
        } catch (IllegalValueException ive) {
            return new IncorrectCommand(ive.getMessage());
        }
    }
}
```
###### /java/seedu/taskmanager/model/Model.java
``` java
    /**
     * Sorts task list based on keywords (startdate or enddate).
     */
    void sortTasks(String keyword);
```
###### /java/seedu/taskmanager/model/Model.java
``` java

    /**
     * Returns the selected task list according to tab selection as an
     * {@code UnmodifiableObservableList<ReadOnlyTask>}
     */
    UnmodifiableObservableList<ReadOnlyTask> getSelectedTaskList();

    /**
     * Returns the filtered task list of incomplete tasks as an
     * {@code UnmodifiableObservableList<ReadOnlyTask>}
     */
    UnmodifiableObservableList<ReadOnlyTask> getFilteredToDoTaskList();

    /**
     * Returns the filtered task list of completed tasks as an
     * {@code UnmodifiableObservableList<ReadOnlyTask>}
     */
    UnmodifiableObservableList<ReadOnlyTask> getFilteredDoneTaskList();
```
###### /java/seedu/taskmanager/model/Model.java
``` java
    /** Sets the currently selected tab in model */
    void setSelectedTab(String selectedTab);
```
###### /java/seedu/taskmanager/model/ModelManager.java
``` java
    private final FilteredList<ReadOnlyTask> filteredTasks;
    private final FilteredList<ReadOnlyTask> filteredToDoTasks;
    private final FilteredList<ReadOnlyTask> filteredDoneTasks;
    private String selectedTab;
```
###### /java/seedu/taskmanager/model/ModelManager.java
``` java
        filteredToDoTasks = new FilteredList<>(this.taskManager.getToDoTaskList());
        filteredDoneTasks = new FilteredList<>(this.taskManager.getDoneTaskList());
        setSelectedTab(TAB_TO_DO); // default tab is to-do task list tab
```
###### /java/seedu/taskmanager/model/ModelManager.java
``` java
    public String getSelectedTab() {
        return selectedTab;
    }

    public void setSelectedTab(String currentTab) {
        this.selectedTab = currentTab;
    }
```
###### /java/seedu/taskmanager/model/ModelManager.java
``` java
    /** Raises an event to indicate an automatic selection */
    private void indicateJumpToListRequestEvent(int index) {
        EventsCenter.getInstance().post(new JumpToListRequestEvent(index));
    }
```
###### /java/seedu/taskmanager/model/ModelManager.java
``` java
        int index = getSelectedTaskList().indexOf(task);
        updateFilteredListToShowAll();
        indicateTaskManagerChanged();
        indicateJumpToListRequestEvent(index);
```
###### /java/seedu/taskmanager/model/ModelManager.java
``` java
        ReadOnlyTask taskToEdit = getSelectedTaskList().get(filteredTaskListIndex);
        int actualIndex = filteredTasks.indexOf(taskToEdit);
        int taskManagerIndex = filteredTasks.getSourceIndex(actualIndex);
        taskManager.updateTask(taskManagerIndex, editedTask);
        int updatedIndex = getSelectedTaskList().indexOf(editedTask);
        indicateTaskManagerChanged();
        indicateJumpToListRequestEvent(updatedIndex);
```
###### /java/seedu/taskmanager/model/ModelManager.java
``` java
    @Override
    public void sortTasks(String keyword) {
        taskManager.sortByDate(keyword);
        updateFilteredListToShowAll();
        indicateTaskManagerChanged();
    }
```
###### /java/seedu/taskmanager/model/ModelManager.java
``` java

    @Override
    public UnmodifiableObservableList<ReadOnlyTask> getSelectedTaskList() {
        switch (selectedTab) {
        case TAB_TO_DO:
            return getFilteredToDoTaskList();
        case TAB_DONE:
            return getFilteredDoneTaskList();
        default:
            assert false : selectedTab + " is invalid";
            return null;
        }
    }

    @Override
    public UnmodifiableObservableList<ReadOnlyTask> getFilteredToDoTaskList() {
        return new UnmodifiableObservableList<>(filteredToDoTasks);
    }

    @Override
    public UnmodifiableObservableList<ReadOnlyTask> getFilteredDoneTaskList() {
        return new UnmodifiableObservableList<>(filteredDoneTasks);
    }

    @Override
    public void updateFilteredListToShowAll() {
        filteredTasks.setPredicate(null);
        filteredToDoTasks.setPredicate(null);
        filteredDoneTasks.setPredicate(null);
    }
```
###### /java/seedu/taskmanager/model/ModelManager.java
``` java
    private void updateFilteredTaskList(Expression expression) {
        filteredTasks.setPredicate(expression::satisfies);
        filteredToDoTasks.setPredicate(expression::satisfies);
        filteredDoneTasks.setPredicate(expression::satisfies);
    }
```
###### /java/seedu/taskmanager/model/task/UniqueTaskList.java
``` java
    public static final String KEYWORD_UNDEFINED = "undefined";
    private String sortCriterion = KEYWORD_UNDEFINED;
```
###### /java/seedu/taskmanager/model/task/UniqueTaskList.java
``` java
    /**
     * Adds a task to the list. Resort the list if it was already sorted.
     *
     * @return index of new task if list is sorted or size-1 if list in unsorted
     *
     * @throws DuplicateTaskException
     *             if the task to add is a duplicate of an existing task in the
     *             list.
     */
    public void add(Task toAdd) throws DuplicateTaskException {
        assert toAdd != null;
        if (contains(toAdd)) {
            throw new DuplicateTaskException();
        }
        internalList.add(toAdd);
```
###### /java/seedu/taskmanager/model/task/UniqueTaskList.java
``` java
        if (!sortCriterion.equals(KEYWORD_UNDEFINED)) {
            sortByDate(sortCriterion);
        }
```
###### /java/seedu/taskmanager/model/task/UniqueTaskList.java
``` java
        if (!sortCriterion.equals(KEYWORD_UNDEFINED)) {
            sortByDate(sortCriterion);
        }
```
###### /java/seedu/taskmanager/model/task/UniqueTaskList.java
``` java

    /**
     * Sorts task list based on keywords (StartDate or EndDate). Tasks without
     * start StartDate or EndDate are ranked at the bottom.
     */
    public void sortByDate(String keyword) {
        this.sortCriterion = keyword;
        internalList.sort(new DateComparator(sortCriterion));
    }

    /**
     * Filters task list based on task status (Done or Not Done).
     */
    public ObservableList<Task> getTaskListByStatus(String status) {
        if (status.equals(Status.STATUS_DONE)) {
            return internalList.filtered(StatusPredicate.isDone());
        } else if (status.equals(Status.STATUS_NOT_DONE)) {
            return internalList.filtered(StatusPredicate.isNotDone());
        } else {
            return internalList; // return list of all task if status is invalid
        }
    }

    static class StatusPredicate {

        public static Predicate<Task> isDone() {
            return p -> p.getStatus().toString().equals(Status.STATUS_DONE);
        }

        public static Predicate<Task> isNotDone() {
            return p -> p.getStatus().toString().equals(Status.STATUS_NOT_DONE);
        }

    }

    class DateComparator implements Comparator<Task> {
        String sortCriterion;

        public DateComparator(String sortCriterion) {
            this.sortCriterion = sortCriterion;
        }

        @Override
        public int compare(Task t1, Task t2) {
            if (sortCriterion.equals(SORT_KEYWORD_STARTDATE)) {
                return this.compareByStartDate(t1, t2);
            } else {
                return this.compareByEndDate(t1, t2);
            }
        }

        private int compareByStartDate(Task t1, Task t2) {
            if (t1.getStartDate().isPresent() && t2.getStartDate().isPresent()) {
                return t1.getStartDate().get().compareTo(t2.getStartDate().get());
            }
```
###### /java/seedu/taskmanager/model/task/UniqueTaskList.java
``` java
        }

        private int compareByEndDate(Task t1, Task t2) {
            if (t1.getEndDate().isPresent() && t2.getEndDate().isPresent()) {
                return t1.getEndDate().get().compareTo(t2.getEndDate().get());
            }
```
###### /java/seedu/taskmanager/model/TaskManager.java
``` java
    /**
     * Sorts task list based on keywords (startdate or enddate).
     */
    public void sortByDate(String keyword) {
        tasks.sortByDate(keyword);
    }
```
###### /java/seedu/taskmanager/ui/MainWindow.java
``` java
    private TaskListPanel toDoTaskListPanel;
    private TaskListPanel doneTaskListPanel;
    private TaskListPanel taskListPanel;
```
###### /java/seedu/taskmanager/ui/MainWindow.java
``` java
    @FXML
    private TabPane taskListsTabPane;

    @FXML
    private AnchorPane taskListPanelPlaceholder;

    @FXML
    private AnchorPane toDoTaskListPanelPlaceholder;

    @FXML
    private AnchorPane doneTaskListPanelPlaceholder;
```
###### /java/seedu/taskmanager/ui/MainWindow.java
``` java
        toDoTaskListPanel = new TaskListPanel(getToDoTaskListPlaceholder(), logic.getFilteredToDoTaskList());
        doneTaskListPanel = new TaskListPanel(getDoneTaskListPlaceholder(), logic.getFilteredDoneTaskList());
```
###### /java/seedu/taskmanager/ui/MainWindow.java
``` java
    private AnchorPane getToDoTaskListPlaceholder() {
        return toDoTaskListPanelPlaceholder;
    }

    private AnchorPane getDoneTaskListPlaceholder() {
        return doneTaskListPanelPlaceholder;
    }

    public TaskListPanel getToDoTaskListPanel() {
        return this.toDoTaskListPanel;
    }

    public TaskListPanel getDoneTaskListPanel() {
        return this.doneTaskListPanel;
    }
```
###### /java/seedu/taskmanager/ui/MainWindow.java
``` java
    @FXML
    public void onSelectedTabChanged() {
        try {
            String selectedTab = taskListsTabPane.getSelectionModel().getSelectedItem().getText();
            logic.setSelectedTab(selectedTab);
        } catch (NullPointerException npe) {
            // null pointer only invoked at initiation
        }
    }

    public TaskListPanel getTaskListPanel() {
        String selectedTab = taskListsTabPane.getSelectionModel().getSelectedItem().getText();
        switch (selectedTab) {
        case TAB_TO_DO:
            return toDoTaskListPanel;
        case TAB_DONE:
            return doneTaskListPanel;
        default:
            assert false : selectedTab + " is invalid";
            return null;
        }
    }
```
###### /resources/view/DarkTheme.css
``` css
 */
.list-cell:selected {
    -fx-background-color: -fx-focus-color;
}

/*
```
###### /resources/view/DarkTheme.css
``` css
 */
.scroll-bar .track {
	-fx-background-color:transparent;
	-fx-border-color:transparent;
}

.scroll-bar .thumb {
    -fx-background-color: derive(#1d1d1d, 50.0%);
    -fx-background-insets: 1.0;
}

.scroll-bar .increment-button, .scroll-bar .decrement-button {
    -fx-background-color: transparent;
    -fx-padding: 0.0 0.0 0.0 0.0;
}

.scroll-bar .increment-arrow, .scroll-bar .decrement-arrow {
    -fx-shape: " ";
}

.scroll-bar:vertical .increment-arrow, .scroll-bar:vertical .decrement-arrow {
    -fx-padding: 1.0 4.0 1.0 4.0;
}

.scroll-bar:horizontal .increment-arrow, .scroll-bar:horizontal .decrement-arrow {
    -fx-padding: 4.0 1.0 4.0 1.0;
}
/*
```
###### /resources/view/Extensions.css
``` css
 */
.menu:hover, .menu-item:hover {
	-fx-background-color: #9ec9cf;
}

.menu:selected:focused:showing, .menu-item:selected:focused {
	-fx-background-color: #8cb3b8;
}

.menu-item:focused {
	-fx-background-color: #8cb3b8;
}

.menu:showing {
	-fx-background-color: #8cb3b8;
}

.split-pane-divider {
    -fx-padding: 1;
}

.tab-header-background {
	-fx-background-color: transparent;
}

.tab {
	-fx-effect: null;
}

#startDate, #endDate {
	-fx-font-size: 8pt;
	-fx-text-fill: derive(#1d1d1d, 30%);
}

#description {
	-fx-font-size: 10pt;
}

/*
```
###### /resources/view/MainWindow.fxml
``` fxml
				<VBox>
					<padding>
						<Insets bottom="5.0" left="5.0" right="5.0" top="5.0" />
					</padding>
					<TabPane fx:id="taskListsTabPane" minWidth="340"
						tabClosingPolicy="UNAVAILABLE" VBox.vgrow="ALWAYS">
						<tabs>
							<Tab fx:id="toDoTaskTab" onSelectionChanged="#onSelectedTabChanged"
								text="To Do">
								<content>
									<AnchorPane fx:id="toDoTaskListPanelPlaceholder" />
								</content>
							</Tab>
							<Tab fx:id="doneTaskTab" onSelectionChanged="#onSelectedTabChanged"
								text="Done">
								<content>
									<AnchorPane fx:id="doneTaskListPanelPlaceholder" />
								</content>
							</Tab>
						</tabs>
					</TabPane>
				</VBox>
```
###### /resources/view/ResultDisplay.fxml
``` fxml
    <AnchorPane fx:id="mainPane">
        <TextArea fx:id="resultDisplay" editable="false" styleClass="result-display" wrapText="true"/>
    </AnchorPane>
```
###### /resources/view/TaskListCard.fxml
``` fxml
                                    <Label fx:id="id" styleClass="cell_big_label" minWidth="30.0"/>
```
